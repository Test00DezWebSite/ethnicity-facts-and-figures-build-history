function PreviewAndEditSection(n){var i,r,o,s;n=n;function a(e){r.classList.contains("hidden")||u()}function c(e){e.preventDefault()}function d(e){p(),o[0]&&(i.classList.contains("empty")?o[0].value="":o[0].value=i.textContent)}function l(e){13==e.keyCode&&u(e)}function u(e){var t;o[0]&&(""==(t=o[0].value.trim())?(i.classList.add("empty"),i.textContent=i.getAttribute("data-empty-text")):(i.textContent=t,i.classList.remove("empty")));s&&(""==(t=s.value.trim())?(i.classList.add("empty"),i.textContent=i.getAttribute("data-empty-text")):(s.classList.contains("for-bullets")?i.innerHTML=t.replace(/^\*\s/gm,"<li>").replace(/\n/g,"</li>"):s.classList.contains("for-paragraphs")?i.innerHTML=t.replace(/\n/g,"<br>").replace(/\n/g,"</li>"):i.innerHTML=t,i.classList.remove("empty")));p()}function v(e){13==e.keyCode&&t()}function m(e){t()}function t(){i.classList.toggle("hidden"),r.classList.toggle("hidden"),o[0]&&o[0].focus(),s&&s.focus()}function p(){r.classList.add("hidden"),i.classList.remove("hidden")}!function(){i=n.querySelector(".preview"),r=n.querySelector(".edit"),o=r.querySelectorAll("input[type=text]"),s=r.querySelector("textarea"),i.addEventListener("click",m),i.addEventListener("keyup",v),1==o.length&&(o[0].addEventListener("blur",a),o[0].addEventListener("keyup",l));s&&s.addEventListener("blur",a);var e=r.querySelector(".cancel");e&&(e.addEventListener("mousedown",c),e.addEventListener("click",d));var t=r.querySelector(".save");t&&t.addEventListener("click",u)}()}function setupAutosave(){for(var e=document.querySelectorAll(".preview-and-edit"),t=0;t<e.length;t++)new PreviewAndEditSection(e[t])}function moveDimensionUp(e){e.preventDefault();var t=$(e.currentTarget).parents("tr:first");0<t.prev().length&&(t.insertBefore(t.prev()),syncDimensionOrder())}function moveDimensionDown(e){e.preventDefault();var t=$(e.currentTarget).parents("tr:last");0<t.next().length&&(t.insertAfter(t.next()),syncDimensionOrder())}function syncDimensionOrder(){var n,e=$("tr.movable"),i=[];$(e).each(function(e,t){n=$(t).data("dimension-guid"),i.push({index:e,guid:n})}),$.ajax({type:"POST",url:set_dimension_order_post_url,dataType:"json",contentType:"application/json",data:JSON.stringify({dimensions:i})})}document.addEventListener("DOMContentLoaded",setupAutosave),document.addEventListener("DOMContentLoaded",function(){for(var e=document.querySelectorAll("select.publisher"),t=0;t<e.length;t++)govukGovernmentOrganisationsAutocomplete({selectElement:e[t],showAllValues:!1,minLength:2,defaultValue:""})}),$(document).ready(function(){$(".move-up").click(moveDimensionUp),$(".move-down").click(moveDimensionDown)});
//# sourceMappingURL=cms_autosave.js.map
