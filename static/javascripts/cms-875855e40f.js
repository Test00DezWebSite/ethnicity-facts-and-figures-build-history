function collapsibleTableBodies(e){for(var t=e.querySelectorAll(".header"),n=0;n<t.length;n++){var r=t[n];r.classList.contains("empty")||r.addEventListener("click",function(e){e.target.parentElement.parentElement.classList.toggle("collapsed")})}}function ethnicityDataValueFields(e){function t(){"true"==r.selectedOptions[0].getAttribute("data-parents")?o.removeAttribute("disabled"):(o.checked=!1,o.setAttribute("disabled","disabled"))}function n(){t()}var e=e;if("querySelector"in document&&"addEventListener"in document&&Function.prototype.bind){var r,o;!function(){e&&(r=e.querySelector("select.ethnicity-categorisation"),o=e.querySelector("input.broad-values"),r&&o&&(r.addEventListener("change",n.bind(this)),t()))}()}}function showHideControl(e){function t(e){e?r.classList.remove("js-hidden"):r.classList.add("js-hidden")}function n(n){t(e.checked),e.setAttribute("aria-expanded",e.checked)}if(document.querySelectorAll&&Function.prototype.bind&&"classList"in document.createElement("_")){var e=e,r=null;!function(){var o=e.getAttribute("aria-controls"),a=e.getAttribute("name");if(o&&(r=document.getElementById(o)),r)for(var u=document.querySelectorAll("input[name="+a+"]"),i=u.length-1;i>=0;i--)u[i].addEventListener("change",n.bind(this));t(e.checked)}()}}function ukCountriesSelect(e){function t(e){for(var t=0,n=r.length-1;n>=0;n--)r[n].checked&&(t+=1);o.checked=t==r.length}function n(){for(var e=r.length-1;e>=0;e--)r[e].checked=o.checked}this.element=e;var r,o;!function(){if(this.element&&"querySelector"in this.element&&"querySelectorAll"in this.element){(o=document.createElement("input")).setAttribute("type","checkbox"),o.setAttribute("id","uk");var e=document.createElement("label");e.setAttribute("for","uk"),e.textContent="All (United Kingdom)";var a=document.createElement("div");a.setAttribute("class","multiple-choice uk"),a.appendChild(o),a.appendChild(e);var u=this.element.querySelector("legend");if(u){if(u.parentElement.insertBefore(a,u.nextSibling),o){o.addEventListener("change",n);for(var i=(r=this.element.querySelectorAll("input.country")).length-1;i>=0;i--)r[i].addEventListener("change",t);t()}}else console.warn("missing legend for UK fieldset")}}()}function validateData(e,t,n){var r=_.clone(e),o=r.shift(),a=_.map(o,function(e){return e.trim().toLowerCase()}),u=index_of_column_named(a,t);if(null===u)return[{error:"could not find data column",column:t,errorType:DATA_ERROR_SETTINGS_ERROR}];if(null!==n){var i=index_of_column_named(a,n);return null===i?[{error:"could not find data column",column:n,errorType:DATA_ERROR_SETTINGS_ERROR}]:validateGroupedData(r,u,i,t,n)}return validateSimpleData(r,u,t)}function validateDataDuplicatesOnly(e,t,n){var r=_.clone(e),o=r.shift(),a=_.map(o,function(e){return e.trim().toLowerCase()}),u=index_of_column_named(a,t);if(null===u)return[{error:"could not find data column",column:t}];if(null!==n){var i=index_of_column_named(a,n);return null===i?[{error:"could not find data column",column:n}]:validateGroupedDataDuplicates(r,u,i)}return validateSimpleData(r,u)}function validateSimpleData(e,t,n){var r=[],o={};return _.forEach(e,function(e){var a=e[t];a in o?"added to errors"!==o[a]&&(r.push({error:"duplicate data",category:a,categoryColumn:n,errorType:DATA_ERROR_DUPLICATION}),o[a]="added to errors"):o[a]="value in dict"}),r}function validateGroupedData(e,t,n,r,o){var a=validateGroupedDataCompleteness(e,t,n,r,o),u=validateGroupedDataDuplicates(e,t,n,r,o);return a.concat(u)}function validateGroupedDataCompleteness(e,t,n,r,o){var a=_.uniq(_.map(e,function(e){return e[t]})),u=_.uniq(_.map(e,function(e){return e[n]})),i=[],l=_.object(_.map(a,function(r){return[r,_.map(_.filter(e,function(e){return e[t]===r}),function(e){return e[n]})]}));return _.forEach(a,function(e){_.forEach(u,function(t){_.contains(l[e],t)||i.push({error:"missing data",category:e,group:t,categoryColumn:r,groupColumn:o,errorType:DATA_ERROR_MISSING_DATA})})}),i}function validateGroupedDataDuplicates(e,t,n,r,o){var a=[],u={};return _.forEach(e,function(e){var i=e[t],l=e[n];i in u?l in u[i]?a.push({error:"duplicate data",category:e[t],group:e[n],categoryColumn:r,groupColumn:o,errorType:DATA_ERROR_DUPLICATION}):u[i][l]=1:(u[i]={},u[i][l]=1)}),a}function errorDescription(e){switch(e.errorType){case DATA_ERROR_SETTINGS_ERROR:return"Column '"+e.column+"' not found";case DATA_ERROR_MISSING_DATA:return"The data is missing a row for "+e.categoryColumn+" = '"+e.category+"' and "+e.groupColumn+" = '"+e.group+"'";case DATA_ERROR_DUPLICATION:return"group"in e?"The data has duplicate entries for the rows with "+e.categoryColumn+" = '"+e.category+"' and "+e.groupColumn+" = '"+e.group+"'":"The data has duplicate entries for "+e.categoryColumn+" = '"+e.category+"'"}}function errorResolutionHint(e){switch(e.errorType){case DATA_ERROR_SETTINGS_ERROR:return"Make sure the column values selected for this table are valid";case DATA_ERROR_MISSING_DATA:return"Add rows to your source spreadsheet and try again";case DATA_ERROR_DUPLICATION:return"Remove data rows in your source spreadsheet and try again"}}function buildChartObject(e,t,n,r,o,a,u,i,l,s,c,p,d){var f=d||"[None]";switch(t.toLowerCase()){case BAR_CHART:var m=_.clone(e),h=m.shift();return o===f||null===o?barchartSingleObject(h,m,r,a,u,l,s,c,p):barchartDoubleObject(h,m,r,o,a,u,l,s,c,p);case LINE_CHART:return linechartObject(e,r,o,l,s,c,p,u);case COMPONENT_CHART:return componentChartObject(e,r,o,l,s,c,p,row_order_column,i);case PANEL_BAR_CHART:return panelBarchartObject(e,r,o,l,s,c,p,u,i);case PANEL_LINE_CHART:return panelLinechartObject(e,o,r,l,s,c,p,i);default:return null}}function barchartObject(e,t,n,r,o,a,u,i,l){var s=_.clone(e),c=s.shift();return isSimpleBarchart(n)?barchartSingleObject(c,s,t,r,o,a,u,i,l):barchartDoubleObject(c,s,t,n,r,o,a,u,i,l)}function isSimpleBarchart(e){return"[None]"===e||null===e}function barchartSingleObject(e,t,n,r,o,a,u,i,l){var s=getIndices(e,n,null,r,o),c=uniqueCategories(t,s.category,s.order),p=_.map(c,function(e){return valueForCategory(t,s.category,s.value,s.parent,e)}),d=[];return null!==s.parent&&(d=_.unique(_.map(t,function(e){return e[s.parent]}))),{type:"bar",title:{text:a},parent_child:null!==s.parent,xAxis:{title:{text:u},categories:c},yAxis:{title:{text:i}},series:[{name:n,data:p}],number_format:l,parents:d,version:VERSION}}function barchartDoubleObject(e,t,n,r,o,a,u,i,l,s){var c=getIndices(e,n,r,o,a),p=uniqueCategories(t,c.category,c.order),d=[];return uniqueDataInColumnMaintainOrder(t,c.secondary).forEach(function(e){var n=_.filter(t,function(t){return t[c.secondary]===e}),r=[];_.forEach(p,function(e){r.push(valueForCategory(n,c.category,c.value,c.parent,e))}),d.push({name:e,data:r})}),{type:"bar",title:{text:u},xAxis:{title:{text:i},categories:p},yAxis:{title:{text:l}},series:sortChartSeries(d),number_format:s,version:VERSION}}function linechartObject(e,t,n,r,o,a,u,i){var l=_.clone(e),s=getIndices(l.shift(),t,n,null,null,"[None]"===i?null:i),c=uniqueDataInColumnMaintainOrder(l,s.category),p=uniqueDataInColumnMaintainOrder(l,s.secondary),d=s.secondary,f=s.custom;if(f){var m=_.map(p,function(e){var t=_.findIndex(l,function(t){return t[d]===e});return l[t][f]});p=_.map(_.sortBy(_.zip(p,m),function(e){return e[1]}),function(e){return e[0]})}var h=[];return _.forEach(p,function(e){var t=[];_.forEach(c,function(n){t.push(valueForCategoryAndSeries(l,s.category,n,s.secondary,e,s.value))}),h.push({name:e,data:t})}),{type:"line",title:{text:r},xAxis:{title:{text:o},categories:c},yAxis:{title:{text:a}},series:sortChartSeries(h),number_format:u,version:VERSION}}function componentChartObject(e,t,n,r,o,a,u,i,l){var s=_.clone(e),c=getIndices(s.shift(),t,n,null,i,l),p=null;p=isUndefinedOrNull(i)||"[None]"===i?uniqueDataInColumnMaintainOrder(s,c.category):uniqueDataInColumnOrdered(s,c.category,c.order);var d=null,f=(d=isUndefinedOrNull(l)||"[None]"===l?uniqueDataInColumnMaintainOrder(s,c.secondary).reverse():uniqueDataInColumnOrdered(s,c.secondary,c.custom).reverse()).map(function(e){var t=p.map(function(t){return valueForCategoryAndSeries(s,c.category,t,c.secondary,e,c.value)});return{name:e,data:t}});return{type:"component",title:{text:r},xAxis:{title:{text:o},categories:p},yAxis:{title:{text:a}},series:f,number_format:u,version:VERSION}}function panelBarchartObject(e,t,n,r,o,a,u,i,l){var s=_.clone(e),c=getIndices(s.shift(),t,n,null,i,l),p=uniqueCategories(s,c.category,c.order),d=null,f=(d=isUndefinedOrNull(l)||"[None]"===l?uniqueDataInColumnMaintainOrder(s,c.secondary):uniqueDataInColumnOrdered(s,c.secondary,c.custom)).map(function(e){var n=_.filter(s,function(t){return t[c.secondary]===e}),r=p.map(function(e){return valueForCategory(n,c.category,c.value,c.parent,e)});return{type:"small_bar",title:{text:e},xAxis:{title:{text:o},categories:p},yAxis:{title:{text:a}},series:[{name:t,data:r}],number_format:u}});return{type:"panel_bar_chart",title:{text:r},xAxis:{title:{text:o},categories:p},yAxis:{title:{text:a}},panels:f,version:VERSION}}function panelLinechartObject(e,t,n,r,o,a,u,i){var l=_.clone(e),s=getIndices(l.shift(),n,t,null,null,i),c=null;c=isUndefinedOrNull(i)||"[None]"===i?uniqueDataInColumnMaintainOrder(l,s.category):uniqueDataInColumnOrdered(l,s.category,s.custom);var p=uniqueDataInColumn(l,s.secondary);return{type:"panel_line_chart",title:{text:r},panels:_.map(c,function(e){var t=_.map(p,function(t){return valueForCategoryAndSeries(l,s.secondary,t,s.category,e,s.value)});return{type:"line",title:{text:e},xAxis:{title:{text:o},categories:p},yAxis:{title:{text:a}},series:[{name:e,data:t}],number_format:u}}),number_format:u,version:VERSION}}function getIndices(e,t,n,r,o,a){var u=_.map(e,function(e){return e.trim().toLowerCase()}),i=isUndefinedOrNull(t)?null:index_of_column_named(u,t),l=isUndefinedOrNull(o)?i:index_of_column_named(u,o),s=isUndefinedOrNull(r)?null:index_of_column_named(u,r),c=isUndefinedOrNull(n)?null:index_of_column_named(u,n),p=isUndefinedOrNull(a)?null:index_of_column_named(u,a);return{category:i>=0?i:null,order:l>=0?l:null,secondary:c>=0?c:null,value:index_of_column_named(u,"value"),parent:s>=0?s:null,custom:p>=0?p:null}}function uniqueCategories(e,t,n){return n?uniqueDataInColumnOrdered(e,t,n):uniqueDataInColumnMaintainOrder(e,t)}function valueForCategory(e,t,n,r,o){var a=e.filter(function(e){return e[t]===o});if(0===a.length)return{y:0,category:o};var u=a[0];if(u[t]===o){var i=isNumber(u[n]);if(r){var l=u[r],s={is_parent:l===o,is_child:l!==o,parent:l};return s.is_parent?{y:i?parseFloat(u[n]):0,relationships:s,category:u[t],color:defaultParentColor,text:i?"number":u[n]}:{y:i?parseFloat(u[n]):0,relationships:s,category:u[t],color:defaultChildColor,text:i?"number":u[n]}}return{y:i?parseFloat(u[n]):0,category:u[t],text:i?"number":u[n]}}}function valueForCategoryAndSeries(e,t,n,r,o,a){var u=_.filter(e,function(e){return e[t]===n&&e[r]===o});return u.length>0?parseFloat(u[0][a]):0}function isNumber(e){return!isNaN(parseFloat(e))}function isUndefinedOrNull(e){return void 0===e||null===e}function sortChartSeries(e){return e.filter(function(e){return isNaN(toNumberSortValue(e.name))}).length>0?e:(e.forEach(function(e){e.name_value=toNumberSortValue(e.name)}),_.sortBy(e,function(e){return e.name_value}))}function toNumberSortValue(e){var t=parseFloat(e);return isNaN(t)?parseFloat(e.substring(1)):t}function buildTableObject(e,t,n,r,o,a,u,i,l,s,c,p){var d=null;return d=u&&u!==NONE_VALUE?groupedTable(e,t,n,r,o,a,u,l,i,s,c,p):simpleTable(e,t,n,r,o,a,l,i,s,c),preProcessTableObject(d)}function preProcessTableObject(e){return"simple"===e.type?preProcessSimpleTableObject(e):"grouped"===e.type&&preProcessGroupedTableObject(e),e}function simpleTable(e,t,n,r,o,a,u,i,l,s){var c=_.clone(e),p=c.shift(),d=_.map(p,function(e){return e.trim().toLowerCase()}),f=index_of_column_named(d,o),m=_.map(u,function(e){return index_of_column_named(d,e)}),h=f,v=!1;if(a&&a!==NONE_VALUE&&(h=index_of_column_named(d,a),v=!0),i&&i!==NONE_VALUE)var b=index_of_column_named(d,i);var g=_.map(c,function(e,t){var n={is_parent:!1,is_child:!1,parent:e[f]};if(v){var r=e[h],o=e[f];n={is_parent:r===o,is_child:r!==o,parent:r}}var a=_.map(m,function(t){return e[t]}),u=_.map(a,function(e){return numVal(e)});return b?{category:e[f],relationships:n,order:e[b],values:a,sort_values:u}:{category:e[f],relationships:n,order:t,values:a,sort_values:u}});return g=_.sortBy(g,function(e){return e.order}),v&&(g=adjustSimpleTableDataForParents(g)),{type:"simple",parent_child:v,header:t,subtitle:n,footer:r,category:o,columns:l,data:g,category_caption:null==s?o:s}}function preProcessSimpleTableObject(e){var t=columnDecimalPlaces(e),n=columnCouldBeAYear(e);e.data=_.map(e.data,function(e){return e.values=_.map(_.zip(e.values,t,n),function(e){return!1===e[2]?formatNumberWithDecimalPlaces(e[0],e[1]):e[0]}),e})}function columnDecimalPlaces(e){var t=[];for(var n in e.data[0].values){var r=_.map(e.data,function(e){return e.values[n]});t.push(seriesDecimalPlaces(r))}return t}function columnCouldBeAYear(e){var t=[];for(var n in e.data[0].values){var r=_.map(e.data,function(e){return e.values[n]});t.push(seriesCouldBeYear(r))}return t}function adjustSimpleTableDataForParents(e){return reorderSimpleTableDataForParentChild(addMissingSimpleTableParentItems(e))}function addMissingSimpleTableParentItems(e){var t=_.uniq(_.map(e,function(e){return e.relationships.parent})),n=_.map(e,function(e){return e.category}),r=_.filter(t,function(e){return!_.contains(n,e)}),o=_.clone(e),a=e[0];return _.forEach(r,function(t){var n=_.filter(e,function(e){return e.relationships.parent===t}),r=_.min(_.map(n,function(e){return e.order}))-1,u={category:t,order:r,relationships:{is_child:!1,is_parent:!0,parent:t},sort_values:_.map(a.sort_values,function(e){return 0}),values:_.map(a.values,function(e){return""})};o.push(u)}),o}function reorderSimpleTableDataForParentChild(e){var t=_.object(_.map(e,function(e){return[e.category,e]})),n=_.uniq(_.map(e,function(e){return e.relationships.parent})),r=[];return _.forEach(n,function(n){r.push(t[n]);var o=_.filter(e,function(e){return e.category!==n&&e.relationships.parent===n});r=r.concat(o)}),r}function groupedTable(e,t,n,r,o,a,u,i,l,s,c,p){var d=_.clone(e),f=d.shift(),m=_.map(f,function(e){return e.trim().toLowerCase()}),h=index_of_column_named(m,o),v=_.map(i,function(e){return index_of_column_named(m,e)}),b=index_of_column_named(m,u),g=-2;null===l?g=h:l!==NONE_VALUE&&(g=index_of_column_named(m,l));var y=h,O=!1;a&&a!==NONE_VALUE&&(y=index_of_column_named(m,a),O=!0);var C=buildDataObjectsByGroup(getDataByGroup(d,b,p,f),d,b,h,O,y,g,-2,v),T=templateGroupTable(o,t,s,C=adjustGroupedTableDataForParents(C)),E=[""].concat(_.map(T.groups,function(e){return e.group})),x=_.map(T.groups[0].data,function(e){return e.category}),A=_.map(x,function(e){return dataItemWithCategory(T,e)});return{group_columns:E,type:"grouped",category:o,group_column:u,columns:s,data:A=_.sortBy(A,function(e){return e.order}),header:t,subtitle:n,footer:r,groups:C=_.map(C,function(e){return e.data=_.sortBy(e.data,function(e){return e.order}),e}),parent_child:O,category_caption:null==c?o:c}}function preProcessGroupedTableObject(e){var t=groupedTableDecimalPlaces(e),n=groupedTableCouldBeAYear(e);e.groups=_.map(e.groups,function(e){return e.data=_.map(e.data,function(e){return e.values=_.map(_.zip(e.values,t,n),function(e){return!1===e[2]?formatNumberWithDecimalPlaces(e[0],e[1]):e[0]}),e}),e}),e.data=[];for(var r in e.groups[0].data){var o=_.clone(e.groups[0].data[r]);o.values=_.flatten(_.map(e.groups,function(e){return e.data[r].values})),o.sort_values=_.flatten(_.map(e.groups,function(e){return e.data[r].sort_values})),e.data.push(o)}var a=_.sortBy(e.groups[0].data,function(e){return e.order}),u=_.map(a,function(e){return e.category});_.forEach(u,function(r){var o="<tr><th>"+r+"</th>";_.forEach(e.groups,function(e){var a=_.findWhere(e.data,{category:r});_.forEach(_.zip(a.values,t,n),function(e){o=e[2]?o+"<td>"+e[0]+"</td>":o+"<td>"+formatNumberWithDecimalPlaces(e[0],e[1])+"</td>"})})})}function groupedTableDecimalPlaces(e){var t=[];for(var n in e.groups[0].data[0].values){var r=_.flatten(_.map(e.groups,function(e){return _.map(e.data,function(e){return e.values[n]})}));t.push(seriesDecimalPlaces(r))}return t}function groupedTableCouldBeAYear(e){var t=[];for(var n in e.groups[0].data[0].values){var r=_.flatten(_.map(e.groups,function(e){return _.map(e.data,function(e){return e.values[n]})}));t.push(seriesCouldBeYear(r))}return t}function buildDataObjectsByGroup(e,t,n,r,o,a,u,i,l){return _.map(e,function(e){var s=_.filter(t,function(t){return t[n]===e}),c=_.map(s,function(e,t){var n={is_parent:!1,is_child:!1,parent:e[r]};if(o){var s=e[a],c=e[r];n={is_parent:s===c,is_child:s!==c,parent:s}}var p=u===i?t:e[u],d=_.map(l,function(t){return e[t]}),f=_.map(d,function(e){return numVal(e)});return{category:e[r],relationships:n,order:p,values:d,sort_values:f}});return{group:e,data:c}})}function getDataByGroup(e,t,n,r){var o=uniqueDataInColumnMaintainOrder(e,t);if(n&&n!==NONE_VALUE){var a=r.indexOf(n),u=_.map(o,function(n){var r=_.findIndex(e,function(e){return e[t]===n});return e[r][a]});o=_.map(_.sortBy(_.zip(o,u),function(e){return e[1]}),function(e){return e[0]})}return o}function dataItemWithCategory(e,t){var n=[],r="",o="",a={};_.forEach(e.groups,function(e){var u=_.findWhere(e.data,{category:t});r=u.order,o=u.parent,a=u.relationships,_.forEach(u.values,function(e){n.push(e)})});var u=_.map(n,function(e){return numVal(e)});return{category:t,relationships:a,parent:o,order:r,values:n,sort_values:u}}function templateGroupTable(e,t,n,r){return{type:"grouped",category:e,title:{text:"Grouped Table"},header:t,columns:n,groups:r}}function adjustGroupedTableDataForParents(e){return reorderGroupedTableDataForParentChild(addMissingGroupedTableParentItems(e))}function addMissingGroupedTableParentItems(e){var t=_.uniq(_.flatten(_.map(e,function(e){return _.map(e.data,function(e){return e.relationships.parent})}))),n=_.uniq(_.flatten(_.map(e,function(e){return _.map(e.data,function(e){return e.category})}))),r=_.filter(t,function(e){return!_.contains(n,e)}),o=_.clone(e),a=e[0].data[0];return _.forEach(r,function(t){var n=_.filter(_.flatten(_.map(e,function(e){return e.data})),function(e){return e.relationships.parent===t}),r=_.min(_.map(n,function(e){return e.order}))-1;_.forEach(o,function(e){var n={category:t,order:r,relationships:{is_child:!1,is_parent:!0,parent:t},sort_values:_.map(a.sort_values,function(e){return 0}),values:_.map(a.values,function(e){return""})};e.data.push(n)})}),o}function reorderGroupedTableDataForParentChild(e){_.object(_.map(e,function(e){return[e.category,e]}));var t=_.uniq(_.flatten(_.map(e,function(e){return _.map(e.data,function(e){return e.relationships.parent})})));return _.forEach(e,function(e){var n=_.object(_.map(e.data,function(e){return[e.category,e]})),r=[];_.forEach(t,function(t){r.push(n[t]);var o=_.filter(e.data,function(e){return e.category!==t&&e.relationships.parent===t});r=r.concat(o)}),e.data=r}),e}function preProcessGroupedTableObject(e){var t=groupedTableDecimalPlaces(e),n=groupedTableCouldBeAYear(e);e.groups=_.map(e.groups,function(e){return e.data=_.map(e.data,function(e){return e.values=_.map(_.zip(e.values,t,n),function(e){return!1===e[2]?formatNumberWithDecimalPlaces(e[0],e[1]):e[0]}),e}),e}),e.data=[];for(var r in e.groups[0].data){var o=_.clone(e.groups[0].data[r]);o.values=_.flatten(_.map(e.groups,function(e){return e.data[r].values})),o.sort_values=_.flatten(_.map(e.groups,function(e){return e.data[r].sort_values})),e.data.push(o)}var a=_.sortBy(e.groups[0].data,function(e){return e.order}),u=_.map(a,function(e){return e.category});_.forEach(u,function(r){var o="<tr><th>"+r+"</th>";_.forEach(e.groups,function(e){var a=_.findWhere(e.data,{category:r});_.forEach(_.zip(a.values,t,n),function(e){o=e[2]?o+"<td>"+e[0]+"</td>":o+"<td>"+formatNumberWithDecimalPlaces(e[0],e[1])+"</td>"})})})}function numVal(e,t){var n=String(e).replace(/\,/g,""),r=Number(n);return r||e}function drawTable(e,t){return preProcessTableObject(t),"simple"===t.type?simpleHtmlTable(e,t):"grouped"===t.type?groupedHtmlTable(e,t):void 0}function simpleHtmlTable(e,t){var n="";return n=appendTableTitle(n,t),n=appendTableSubtitle(n,t,!0),n+="<table class='table table-sm'>",n=appendSimpleTableHeader(n,t),n=appendSimpleTableBody(n,t),n+="</table>",$("#"+e).html(n),!0}function appendSimpleTableHeader(e,t){var n="";return n=null==t.category_caption?"<thead><tr><th></th>":"<thead><tr><th>"+t.category_caption+"</th>",_.forEach(t.columns,function(e){n=n+"<th>"+e+"</th>"}),n+="</tr></thead>",e+n}function appendSimpleTableBody(e,t){var n="<tbody>";return _.forEach(t.data,function(e){n+="<tr>",t.parent_child?e.relationships.is_parent?n+='<th class="parent_row">':n+='<th class="child_row">':n+="<th>",n=n+e.category+"</th>",_.forEach(e.values,function(e){n=n+"<td>"+e+"</td>"}),n+="</tr>"}),n+="</tbody>",e+n}function groupedHtmlTable(e,t){var n="";return n=appendTableTitle(n,t),n=appendTableSubtitle(n,t),n+="<table class='table table-sm'>",n=appendGroupTableHeader(n,t),n=appendGroupedTableBody(n,t),n+="</table>",n=insertTableFooter(n,t),$("#"+e).html(n),!0}function appendGroupedTableBody(e,t){var n="<tbody>",r=_.sortBy(t.groups[0].data,function(e){return e.order});return _.forEach(r,function(e){var r=e.category,o="<tr>";t.parent_child?e.relationships.is_parent?o+='<th class="parent_row">':o+='<th class="child_row">':o+="<th>",o=o+r+"</th>",_.forEach(t.groups,function(e){var t=_.findWhere(e.data,{category:r});_.forEach(t.values,function(e){o=o+"<td>"+e+"</td>"})}),n+=o+="</tr>"}),n+="</tbody>",e+n}function appendGroupTableHeader(e,t){var n="";n=null==t.category_caption?"<thead><tr><th></th>":"<thead><tr><th>"+t.category_caption+"</th>",_.forEach(t.groups,function(e){n+=multicell(e.group,t.columns.length)}),n+="</tr>";var r=!1;return _.forEach(t.columns,function(e){""!==e&&(r=!0)}),r&&(n+="<tr><td></td>",_.forEach(t.groups,function(e){_.forEach(t.columns,function(e){n=n+"<td>"+e+"</td>"})}),n+="</tr>"),n+="</thead>",e+n}function appendTableTitle(e,t){return t.header&&""!==t.header?e+"<div class='table-title heading-small'>"+t.header+"</div>":e}function appendTableSubtitle(e,t){return t.subtitle&&""!==t.subtitle?e+"<div class='table-subtitle'>"+t.subtitle+"</div>":e}function insertTableFooter(e,t){return t.footer&&""!==t.footer?e+"<div class='table-footer'>"+t.footer+"</div>":e}function multicell(e,t){return"<td colspan="+t+">"+e+"</td>"}!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.accessibleAutocomplete=t():e.accessibleAutocomplete=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=1)}([function(e,t,n){!function(){"use strict";function t(){}function n(e,n){var r,o,a,u,i=S;for(u=arguments.length;u-- >2;)w.push(arguments[u]);for(n&&null!=n.children&&(w.length||w.push(n.children),delete n.children);w.length;)if((o=w.pop())&&void 0!==o.pop)for(u=o.length;u--;)w.push(o[u]);else!0!==o&&!1!==o||(o=null),(a="function"!=typeof e)&&(null==o?o="":"number"==typeof o?o=String(o):"string"!=typeof o&&(a=!1)),a&&r?i[i.length-1]+=o:i===S?i=[o]:i.push(o),r=a;var l=new t;return l.nodeName=e,l.children=i,l.attributes=null==n?void 0:n,l.key=null==n?void 0:n.key,void 0!==R.vnode&&R.vnode(l),l}function r(e,t){for(var n in t)e[n]=t[n];return e}function o(e){!e.__d&&(e.__d=!0)&&1==P.push(e)&&(R.debounceRendering||setTimeout)(a)}function a(){var e,t=P;for(P=[];e=t.pop();)e.__d&&x(e)}function u(e,t,n){return"string"==typeof t||"number"==typeof t?void 0!==e.splitText:"string"==typeof t.nodeName?!e._componentConstructor&&i(e,t.nodeName):n||e._componentConstructor===t.nodeName}function i(e,t){return e.__n===t||e.nodeName.toLowerCase()===t.toLowerCase()}function l(e){var t=r({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var o in n)void 0===t[o]&&(t[o]=n[o]);return t}function s(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.__n=e,n}function c(e){e.parentNode&&e.parentNode.removeChild(e)}function p(e,t,n,r,o){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)n&&n(null),r&&r(e);else if("class"!==t||o)if("style"===t){if(r&&"string"!=typeof r&&"string"!=typeof n||(e.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var a in n)a in r||(e.style[a]="");for(var a in r)e.style[a]="number"==typeof r[a]&&!1===I.test(a)?r[a]+"px":r[a]}}else if("dangerouslySetInnerHTML"===t)r&&(e.innerHTML=r.__html||"");else if("o"==t[0]&&"n"==t[1]){var u=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,f,u):e.removeEventListener(t,f,u),(e.__l||(e.__l={}))[t]=r}else if("list"!==t&&"type"!==t&&!o&&t in e)d(e,t,null==r?"":r),null!=r&&!1!==r||e.removeAttribute(t);else{var i=o&&t!==(t=t.replace(/^xlink\:?/,""));null==r||!1===r?i?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof r&&(i?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}else e.className=r||""}function d(e,t,n){try{e[t]=n}catch(e){}}function f(e){return this.__l[e.type](R.event&&R.event(e)||e)}function m(){for(var e;e=j.pop();)R.afterMount&&R.afterMount(e),e.componentDidMount&&e.componentDidMount()}function _(e,t,n,r,o,a){q++||(L=null!=o&&void 0!==o.ownerSVGElement,B=null!=e&&!("__preactattr_"in e));var u=h(e,t,n,r,a);return o&&u.parentNode!==o&&o.appendChild(u),--q||(B=!1,a||m()),u}function h(e,t,n,r,o){var a=e,u=L;if(null==t&&(t=""),"string"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||o)?e.nodeValue!=t&&(e.nodeValue=t):(a=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(a,e),b(e,!0))),a.__preactattr_=!0,a;if("function"==typeof t.nodeName)return A(e,t,n,r);if(L="svg"===t.nodeName||"foreignObject"!==t.nodeName&&L,(!e||!i(e,String(t.nodeName)))&&(a=s(String(t.nodeName),L),e)){for(;e.firstChild;)a.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(a,e),b(e,!0)}var l=a.firstChild,c=a.__preactattr_||(a.__preactattr_={}),p=t.children;return!B&&p&&1===p.length&&"string"==typeof p[0]&&null!=l&&void 0!==l.splitText&&null==l.nextSibling?l.nodeValue!=p[0]&&(l.nodeValue=p[0]):(p&&p.length||null!=l)&&v(a,p,n,r,B||null!=c.dangerouslySetInnerHTML),y(a,t.attributes,c),L=u,a}function v(e,t,n,r,o){var a,i,l,s,p=e.childNodes,d=[],f={},m=0,_=0,v=p.length,g=0,y=t?t.length:0;if(0!==v)for(E=0;E<v;E++){var O=p[E],C=O.__preactattr_;null!=(T=y&&C?O._component?O._component.__k:C.key:null)?(m++,f[T]=O):(C||(void 0!==O.splitText?!o||O.nodeValue.trim():o))&&(d[g++]=O)}if(0!==y)for(E=0;E<y;E++){s=null;var T=(l=t[E]).key;if(null!=T)m&&void 0!==f[T]&&(s=f[T],f[T]=void 0,m--);else if(!s&&_<g)for(a=_;a<g;a++)if(void 0!==d[a]&&u(i=d[a],l,o)){s=i,d[a]=void 0,a===g-1&&g--,a===_&&_++;break}(s=h(s,l,n,r))&&s!==e&&(E>=v?e.appendChild(s):s!==p[E]&&(s===p[E+1]?c(p[E]):e.insertBefore(s,p[E]||null)))}if(m)for(var E in f)void 0!==f[E]&&b(f[E],!1);for(;_<=g;)void 0!==(s=d[g--])&&b(s,!1)}function b(e,t){var n=e._component;n?N(n):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||c(e),g(e))}function g(e){for(e=e.lastChild;e;){var t=e.previousSibling;b(e,!0),e=t}}function y(e,t,n){var r;for(r in n)t&&null!=t[r]||null==n[r]||p(e,r,n[r],n[r]=void 0,L);for(r in t)"children"===r||"innerHTML"===r||r in n&&t[r]===("value"===r||"checked"===r?e[r]:n[r])||p(e,r,n[r],n[r]=t[r],L)}function O(e){var t=e.constructor.name;(M[t]||(M[t]=[])).push(e)}function C(e,t,n){var r,o=M[e.name];if(e.prototype&&e.prototype.render?(r=new e(t,n),D.call(r,t,n)):(r=new D(t,n),r.constructor=e,r.render=T),o)for(var a=o.length;a--;)if(o[a].constructor===e){r.__b=o[a].__b,o.splice(a,1);break}return r}function T(e,t,n){return this.constructor(e,n)}function E(e,t,n,r,a){e.__x||(e.__x=!0,(e.__r=t.ref)&&delete t.ref,(e.__k=t.key)&&delete t.key,!e.base||a?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.__c||(e.__c=e.context),e.context=r),e.__p||(e.__p=e.props),e.props=t,e.__x=!1,0!==n&&(1!==n&&!1===R.syncComponentUpdates&&e.base?o(e):x(e,1,a)),e.__r&&e.__r(e))}function x(e,t,n,o){if(!e.__x){var a,u,i,s=e.props,c=e.state,p=e.context,d=e.__p||s,f=e.__s||c,h=e.__c||p,v=e.base,g=e.__b,y=v||g,O=e._component,T=!1;if(v&&(e.props=d,e.state=f,e.context=h,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(s,c,p)?T=!0:e.componentWillUpdate&&e.componentWillUpdate(s,c,p),e.props=s,e.state=c,e.context=p),e.__p=e.__s=e.__c=e.__b=null,e.__d=!1,!T){a=e.render(s,c,p),e.getChildContext&&(p=r(r({},p),e.getChildContext()));var A,D,w=a&&a.nodeName;if("function"==typeof w){var S=l(a);(u=O)&&u.constructor===w&&S.key==u.__k?E(u,S,1,p,!1):(A=u,e._component=u=C(w,S,p),u.__b=u.__b||g,u.__u=e,E(u,S,0,p,!1),x(u,1,n,!0)),D=u.base}else i=y,(A=O)&&(i=e._component=null),(y||1===t)&&(i&&(i._component=null),D=_(i,a,p,n||!v,y&&y.parentNode,!0));if(y&&D!==y&&u!==O){var I=y.parentNode;I&&D!==I&&(I.replaceChild(D,y),A||(y._component=null,b(y,!1)))}if(A&&N(A),e.base=D,D&&!o){for(var P=e,L=e;L=L.__u;)(P=L).base=D;D._component=P,D._componentConstructor=P.constructor}}if(!v||n?j.unshift(e):T||(m(),e.componentDidUpdate&&e.componentDidUpdate(d,f,h),R.afterUpdate&&R.afterUpdate(e)),null!=e.__h)for(;e.__h.length;)e.__h.pop().call(e);q||o||m()}}function A(e,t,n,r){for(var o=e&&e._component,a=o,u=e,i=o&&e._componentConstructor===t.nodeName,s=i,c=l(t);o&&!s&&(o=o.__u);)s=o.constructor===t.nodeName;return o&&s&&(!r||o._component)?(E(o,c,3,n,r),e=o.base):(a&&!i&&(N(a),e=u=null),o=C(t.nodeName,c,n),e&&!o.__b&&(o.__b=e,u=null),E(o,c,1,n,r),e=o.base,u&&e!==u&&(u._component=null,b(u,!1))),e}function N(e){R.beforeUnmount&&R.beforeUnmount(e);var t=e.base;e.__x=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?N(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.__b=t,c(t),O(e),g(t)),e.__r&&e.__r(null)}function D(e,t){this.__d=!0,this.context=t,this.props=e,this.state=this.state||{}}var R={},w=[],S=[],I=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,P=[],j=[],q=0,L=!1,B=!1,M={};r(D.prototype,{setState:function(e,t){var n=this.state;this.__s||(this.__s=r({},n)),r(n,"function"==typeof e?e(n,this.props):e),t&&(this.__h=this.__h||[]).push(t),o(this)},forceUpdate:function(e){e&&(this.__h=this.__h||[]).push(e),x(this,2)},render:function(){}});var k={h:n,createElement:n,cloneElement:function(e,t){return n(e.nodeName,r(r({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)},Component:D,render:function(e,t,n){return _(n,e,{},!1,t,!1)},rerender:a,options:R};e.exports=k}()},function(e,t,n){e.exports=n(2)},function(e,t,n){"use strict";function r(e){if(!e.element)throw new Error("element is not defined");if(!e.id)throw new Error("id is not defined");if(!e.source)throw new Error("source is not defined");Array.isArray(e.source)&&(e.source=i(e.source)),(0,a.render)((0,a.createElement)(u.default,e),e.element)}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(0),u=function(e){return e&&e.__esModule?e:{default:e}}(n(3)),i=function(e){return function(t,n){n(e.filter(function(e){return-1!==e.toLowerCase().indexOf(t.toLowerCase())}))}};r.enhanceSelectElement=function(e){if(!e.selectElement)throw new Error("selectElement is not defined");if(!e.source){var t=[].filter.call(e.selectElement.options,function(t){return t.value||e.preserveNullOptions});e.source=t.map(function(e){return e.textContent||e.innerText})}if(e.onConfirm=e.onConfirm||function(t){var n=[].filter.call(e.selectElement.options,function(e){return(e.textContent||e.innerText)===t})[0];n&&(n.selected=!0)},e.selectElement.value||void 0===e.defaultValue){var n=e.selectElement.options[e.selectElement.options.selectedIndex];e.defaultValue=n.textContent||n.innerText}void 0===e.name&&(e.name=""),void 0===e.id&&(void 0===e.selectElement.id?e.id="":e.id=e.selectElement.id),void 0===e.autoselect&&(e.autoselect=!0);var a=document.createElement("span");e.selectElement.parentNode.insertBefore(a,e.selectElement),r(o({},e,{element:a})),e.selectElement.style.display="none",e.selectElement.id=e.selectElement.id+"-select"},e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){}function a(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){"function"!=typeof t&&null!==t||(e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t))}function i(){return!(!navigator.userAgent.match(/(iPod|iPhone|iPad)/g)||!navigator.userAgent.match(/AppleWebKit/g))}function l(e){return e>47&&e<58||32===e||8===e||e>64&&e<91||e>95&&e<112||e>185&&e<193||e>218&&e<223}function s(e){return h?{onInput:e}:v?{onChange:e}:void 0}t.__esModule=!0,t.default=void 0;var c,p,d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=n(0),m=r(n(4)),_=r(n(5)),h=!0,v=!1,b={13:"enter",27:"escape",32:"space",38:"up",40:"down"},g=function(){var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}(),y=(p=c=function(e){function t(n){o(this,t);var r=a(this,e.call(this,n));return r.elementReferences={},r.state={focused:null,hovered:null,menuOpen:!1,options:n.defaultValue?[n.defaultValue]:[],query:n.defaultValue,selected:null},r.handleComponentBlur=r.handleComponentBlur.bind(r),r.handleKeyDown=r.handleKeyDown.bind(r),r.handleUpArrow=r.handleUpArrow.bind(r),r.handleDownArrow=r.handleDownArrow.bind(r),r.handleEnter=r.handleEnter.bind(r),r.handlePrintableKey=r.handlePrintableKey.bind(r),r.handleOptionBlur=r.handleOptionBlur.bind(r),r.handleOptionClick=r.handleOptionClick.bind(r),r.handleOptionFocus=r.handleOptionFocus.bind(r),r.handleOptionMouseDown=r.handleOptionMouseDown.bind(r),r.handleOptionMouseEnter=r.handleOptionMouseEnter.bind(r),r.handleOptionMouseOut=r.handleOptionMouseOut.bind(r),r.handleInputBlur=r.handleInputBlur.bind(r),r.handleInputChange=r.handleInputChange.bind(r),r.handleInputFocus=r.handleInputFocus.bind(r),r.pollInputElement=r.pollInputElement.bind(r),r.getDirectInputChanges=r.getDirectInputChanges.bind(r),r}return u(t,e),t.prototype.componentDidMount=function(){this.pollInputElement()},t.prototype.componentWillUnmount=function(){clearTimeout(this.$pollInput)},t.prototype.pollInputElement=function(){var e=this;this.getDirectInputChanges(),this.$pollInput=setTimeout(function(){e.pollInputElement()},100)},t.prototype.getDirectInputChanges=function(){var e=this.elementReferences[-1];e&&e.value!==this.state.query&&this.handleInputChange({target:{value:e.value}})},t.prototype.componentDidUpdate=function(e,t){var n=this.state.focused,r=null===n,o=t.focused!==n;o&&!r&&this.elementReferences[n].focus();var a=-1===n,u=o&&null===t.focused;if(a&&u){var i=this.elementReferences[n];i.setSelectionRange(0,i.value.length)}},t.prototype.hasAutoselect=function(){return!i()&&this.props.autoselect},t.prototype.templateInputValue=function(e){var t=this.props.templates&&this.props.templates.inputValue;return t?t(e):e},t.prototype.templateSuggestion=function(e){var t=this.props.templates&&this.props.templates.suggestion;return t?t(e):e},t.prototype.handleComponentBlur=function(e){var t=this.state,n=t.options,r=t.query,o=t.selected,a=void 0;this.props.confirmOnBlur?(a=e.query||r,this.props.onConfirm(n[o])):a=r,this.setState({focused:null,menuOpen:e.menuOpen||!1,query:a,selected:null})},t.prototype.handleOptionBlur=function(e,t){var n=this.state,r=n.focused,o=n.menuOpen,a=n.options,u=n.selected,l=null===e.relatedTarget,s=e.relatedTarget===this.elementReferences[-1],c=r!==t&&-1!==r;if(!c&&l||!c&&!s){var p=o&&i();this.handleComponentBlur({menuOpen:p,query:this.templateInputValue(a[u])})}},t.prototype.handleInputBlur=function(e){var t=this.state,n=t.focused,r=t.menuOpen,o=t.options,a=t.query,u=t.selected;if(-1===n){var l=r&&i(),s=i()?a:this.templateInputValue(o[u]);this.handleComponentBlur({menuOpen:l,query:s})}},t.prototype.handleInputChange=function(e){var t=this,n=this.props,r=n.minLength,o=n.source,a=n.showAllValues,u=this.hasAutoselect(),i=e.target.value,l=0===i.length,s=this.state.query.length!==i.length,c=i.length>=r;this.setState({query:i}),a||!l&&s&&c?o(i,function(e){var n=e.length>0;t.setState({menuOpen:n,options:e,selected:u&&n?0:-1})}):!l&&c||this.setState({menuOpen:!1,options:[]})},t.prototype.handleInputClick=function(e){this.handleInputChange(e)},t.prototype.handleInputFocus=function(e){this.setState({focused:-1})},t.prototype.handleOptionFocus=function(e){this.setState({focused:e,hovered:null,selected:e})},t.prototype.handleOptionMouseEnter=function(e,t){this.setState({hovered:t})},t.prototype.handleOptionMouseOut=function(e,t){this.setState({hovered:null})},t.prototype.handleOptionClick=function(e,t){var n=this.state.options[t],r=this.templateInputValue(n);this.props.onConfirm(n),this.setState({focused:-1,menuOpen:!1,query:r,selected:-1}),this.forceUpdate()},t.prototype.handleOptionMouseDown=function(e){e.preventDefault()},t.prototype.handleUpArrow=function(e){e.preventDefault();var t=this.state,n=t.menuOpen,r=t.selected;-1!==r&&n&&this.handleOptionFocus(r-1)},t.prototype.handleDownArrow=function(e){var t=this;if(e.preventDefault(),this.props.showAllValues&&!1===this.state.menuOpen)e.preventDefault(),this.props.source("",function(e){t.setState({menuOpen:!0,options:e,selected:0,focused:0,hovered:null})});else if(!0===this.state.menuOpen){var n=this.state,r=n.menuOpen,o=n.options,a=n.selected;a!==o.length-1&&r&&this.handleOptionFocus(a+1)}},t.prototype.handleSpace=function(e){var t=this;this.props.showAllValues&&!1===this.state.menuOpen&&(e.preventDefault(),this.props.source("",function(e){t.setState({menuOpen:!0,options:e})})),-1!==this.state.focused&&(e.preventDefault(),this.handleOptionClick(e,this.state.focused))},t.prototype.handleEnter=function(e){this.state.menuOpen&&(e.preventDefault(),this.state.selected>=0&&this.handleOptionClick(e,this.state.selected))},t.prototype.handlePrintableKey=function(e){var t=this.elementReferences[-1];e.target===t||t.focus()},t.prototype.handleKeyDown=function(e){switch(b[e.keyCode]){case"up":this.handleUpArrow(e);break;case"down":this.handleDownArrow(e);break;case"space":this.handleSpace(e);break;case"enter":this.handleEnter(e);break;case"escape":this.handleComponentBlur({query:this.state.query});break;default:l(e.keyCode)&&this.handlePrintableKey(e)}},t.prototype.render=function(){var e=this,t=this.props,n=t.cssNamespace,r=t.displayMenu,o=t.id,a=t.minLength,u=t.name,i=t.placeholder,l=t.required,c=t.showAllValues,p=t.tNoResults,_=t.tStatusQueryTooShort,h=t.tStatusNoResults,v=t.tStatusSelectedOption,b=t.tStatusResults,y=t.dropdownArrow,O=this.state,C=O.focused,T=O.hovered,E=O.menuOpen,x=O.options,A=O.query,N=O.selected,D=this.hasAutoselect(),R=-1===C,w=0===x.length,S=0!==A.length,I=A.length>=a,P=this.props.showNoOptionsFound&&R&&w&&S&&I,j=n+"__wrapper",q=n+"__input",L=null!==C?" "+q+"--focused":"",B=this.props.showAllValues?" "+q+"--show-all-values":" "+q+"--default",M=n+"__dropdown-arrow-down",k=-1!==C&&null!==C,U=n+"__menu",V=U+"--"+r,G=U+"--"+(E||P?"visible":"hidden"),F=n+"__option",H=n+"__hint",W=this.templateInputValue(x[N]),$=W&&0===W.toLowerCase().indexOf(A.toLowerCase())&&D?A+W.substr(A.length):"",K=g&&$,Y=void 0;return c&&"string"==typeof(Y=y({className:M}))&&(Y=(0,f.createElement)("div",{className:n+"__dropdown-arrow-down-wrapper",dangerouslySetInnerHTML:{__html:Y}})),(0,f.createElement)("div",{className:j,onKeyDown:this.handleKeyDown,role:"combobox","aria-expanded":E?"true":"false"},(0,f.createElement)(m.default,{length:x.length,queryLength:A.length,minQueryLength:a,selectedOption:this.templateInputValue(x[N]),tQueryTooShort:_,tNoResults:h,tSelectedOption:v,tResults:b}),K&&(0,f.createElement)("span",null,(0,f.createElement)("input",{className:H,readonly:!0,tabIndex:"-1",value:$})),(0,f.createElement)("input",d({"aria-activedescendant":!!k&&o+"__option--"+C,"aria-owns":o+"__listbox",autoComplete:"off",className:""+q+L+B,id:o,onClick:function(t){return e.handleInputClick(t)},onBlur:this.handleInputBlur},s(this.handleInputChange),{onFocus:this.handleInputFocus,name:u,placeholder:i,ref:function(t){e.elementReferences[-1]=t},type:"text",role:"textbox",required:l,value:A})),Y,(0,f.createElement)("ul",{className:U+" "+V+" "+G,id:o+"__listbox",role:"listbox"},x.map(function(t,n){var r=(-1===C?N===n:C===n)&&null===T?" "+F+"--focused":"",a=n%2?" "+F+"--odd":"";return(0,f.createElement)("li",{"aria-selected":C===n,className:""+F+r+a,dangerouslySetInnerHTML:{__html:e.templateSuggestion(t)},id:o+"__option--"+n,key:n,onFocusOut:function(t){return e.handleOptionBlur(t,n)},onClick:function(t){return e.handleOptionClick(t,n)},onMouseDown:e.handleOptionMouseDown,onMouseEnter:function(t){return e.handleOptionMouseEnter(t,n)},onMouseOut:function(t){return e.handleOptionMouseOut(t,n)},ref:function(t){e.elementReferences[n]=t},role:"option",tabIndex:"-1"})}),P&&(0,f.createElement)("li",{className:F+" "+F+"--no-results"},p())))},t}(f.Component),c.defaultProps={autoselect:!1,cssNamespace:"autocomplete",defaultValue:"",displayMenu:"inline",minLength:0,name:"input-autocomplete",placeholder:"",onConfirm:function(){},confirmOnBlur:!0,showNoOptionsFound:!0,showAllValues:!1,required:!1,tNoResults:function(){return"No results found"},dropdownArrow:_.default},p);t.default=y},function(e,t,n){"use strict";function r(e,t){}function o(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){"function"!=typeof t&&null!==t||(e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t))}t.__esModule=!0,t.default=void 0;var u,i,l=n(0),s=(i=u=function(e){function t(){var n,a,u;r(this,t);for(var i=arguments.length,l=Array(i),s=0;s<i;s++)l[s]=arguments[s];return n=a=o(this,e.call.apply(e,[this].concat(l))),a.state={bump:!1},u=n,o(a,u)}return a(t,e),t.prototype.componentWillReceiveProps=function(e){e.queryLength!==this.props.queryLength&&this.setState(function(e){return{bump:!e.bump}})},t.prototype.render=function(){var e=this.props,t=e.length,n=e.queryLength,r=e.minQueryLength,o=e.selectedOption,a=e.tQueryTooShort,u=e.tNoResults,i=e.tSelectedOption,s=e.tResults,c=this.state.bump,p=n<r,d=0===t,f=o?i(o,t):"",m=null;return m=p?a(r):d?u():s(t,f),(0,l.createElement)("div",{"aria-atomic":"true","aria-live":"polite",role:"status",style:{border:"0",clip:"rect(0 0 0 0)",height:"1px",marginBottom:"-1px",marginRight:"-1px",overflow:"hidden",padding:"0",position:"absolute",whiteSpace:"nowrap",width:"1px"}},m,(0,l.createElement)("span",null,c?",":",,"))},t}(l.Component),u.defaultProps={tQueryTooShort:function(e){return"Type in "+e+" or more characters for results."},tNoResults:function(){return"No search results."},tSelectedOption:function(e,t){return e+" (1 of "+t+") is selected."},tResults:function(e,t){var n={result:1===e?"result":"results",is:1===e?"is":"are"};return e+" "+n.result+" "+n.is+" available. "+t}},i);t.default=s},function(e,t,n){"use strict";t.__esModule=!0;var r=n(0);t.default=function(e){var t=e.className;return(0,r.createElement)("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:t,focusable:"false"},(0,r.createElement)("g",{stroke:"none",fill:"none","fill-rule":"evenodd"},(0,r.createElement)("polygon",{fill:"#000000",points:"0 0 22 0 11 17"})))}}])});var govukGovernmentOrganisationsAutocomplete=function(e){e.source=function(t,n){var r=[].filter.call(e.selectElement.options,function(e){return""!=e.value}).map(function(e){var t=e.getAttribute("data-abbreviations");t=t?t.split("|"):[];var n=e.getAttribute("data-other-names");return n=n?n.split("|"):[],{current_name:e.label,abbreviations:t,other_names:n}}),o=t.trim().split(/\s+/).map(function(e){return new RegExp("\\b"+e,"i")});return n(r.map(function(e){var t=[e.current_name].concat(e.other_names).concat(e.abbreviations).filter(function(e){return e});e.resultPosition=null;for(var n=0;n<t.length;n++){var r=o.reduce(function(e,r){return matchPosition=t[n].search(r),matchPosition>-1&&(e.count+=1,(-1==e.lowestPosition||matchPosition<e.lowestPosition)&&(e.lowestPosition=matchPosition)),e},{count:0,lowestPosition:-1});r.count==o.length&&(null==e.resultPosition||r.lowestPosition<e.resultPosition)&&(e.resultPosition=r.lowestPosition)}return e}).filter(function(e){return null!=e.resultPosition}).sort(function(e,t){return e.resultPosition<t.resultPosition?-1:e.resultPosition>t.resultPosition?1:0}).map(function(e){return e.current_name}))},accessibleAutocomplete.enhanceSelectElement(e)},DATA_ERROR_DUPLICATION="duplication",DATA_ERROR_MISSING_DATA="missing data",DATA_ERROR_SETTINGS_ERROR="settings";if("undefined"!=typeof exports){var _=require("../charts/vendor/underscore-min"),index_of_column_named=(dataTools=require("../charts/rd-data-tools")).index_of_column_named;exports.validateSimpleData=validateSimpleData,exports.validateGroupedData=validateGroupedData,exports.validateData=validateData,exports.DATA_ERROR_DUPLICATION=DATA_ERROR_DUPLICATION,exports.DATA_ERROR_MISSING_DATA=DATA_ERROR_MISSING_DATA,exports.DATA_ERROR_SETTINGS_ERROR=DATA_ERROR_SETTINGS_ERROR}var defaultParentColor="#2B8CC4",defaultChildColor="#B3CBD9",VERSION="1.1",BAR_CHART="bar",LINE_CHART="line",COMPONENT_CHART="component",PANEL_BAR_CHART="panel_bar",PANEL_LINE_CHART="panel_line";if("undefined"!=typeof exports){var _=require("../charts/vendor/underscore-min"),dataTools=require("../charts/rd-data-tools"),builderTools=require("../cms/rd-builder"),index_of_column_named=dataTools.index_of_column_named,uniqueDataInColumnMaintainOrder=dataTools.uniqueDataInColumnMaintainOrder,getColumnIndex=builderTools.getColumnIndex;exports.barchartObject=barchartObject,exports.linechartObject=linechartObject,exports.componentChartObject=componentChartObject,exports.panelLinechartObject=panelLinechartObject,exports.panelBarchartObject=panelBarchartObject}var NONE_VALUE="[None]";if("undefined"!=typeof exports){var _=require("../charts/vendor/underscore-min"),dataTools=require("../charts/rd-data-tools"),builderTools=require("../cms/rd-builder"),uniqueDataInColumnMaintainOrder=dataTools.uniqueDataInColumnMaintainOrder,seriesDecimalPlaces=dataTools.seriesDecimalPlaces,seriesCouldBeYear=dataTools.seriesCouldBeYear,formatNumberWithDecimalPlaces=dataTools.formatNumberWithDecimalPlaces,getColumnIndex=builderTools.getColumnIndex,index_of_column_named=dataTools.index_of_column_named;exports.buildTableObject=buildTableObject,exports.simpleTable=simpleTable,exports.groupedTable=groupedTable}$(document).ready(function(){var e=$(".sticky-js");$.each(e,function(){var e=parseInt($(this).position().top);$(window).scroll(function(){$(window).scrollTop()>=e?$(this).addClass("sticky-js-fixed"):$(this).removeClass("sticky-js-fixed")}.bind(this))})});
//# sourceMappingURL=cms.js.map
