function showHideControl(e){function t(e){e?n.classList.remove("js-hidden"):n.classList.add("js-hidden")}function r(r){t(e.checked),e.setAttribute("aria-expanded",e.checked)}if(document.querySelectorAll&&Function.prototype.bind&&"classList"in document.createElement("_")){var e=e,n=null;!function(){var a=e.getAttribute("aria-controls"),o=e.getAttribute("name");if(a&&(n=document.getElementById(a)),n)for(var u=document.querySelectorAll("input[name="+o+"]"),i=u.length-1;i>=0;i--)u[i].addEventListener("change",r.bind(this));t(e.checked)}()}}function barchartObject(e,t,r,n,a,o,u,i,l){var c=_.clone(e),s=c.shift();return isSimpleBarchart(r)?barchartSingleObject(s,c,t,n,a,o,u,i,l):barchartDoubleObject(s,c,t,r,n,a,o,u,i,l)}function isSimpleBarchart(e){return"[None]"===e||null===e}function barchartSingleObject(e,t,r,n,a,o,u,i,l){var c=getIndices(e,r,null,n,a),s=uniqueCategories(t,c.category,c.order),d=_.map(s,function(e){return valueForCategory(t,c.category,c.value,c.parent,e)}),p=[];return null!==c.parent&&(p=_.unique(_.map(t,function(e){return e[c.parent]}))),{type:"bar",title:{text:o},parent_child:null!==c.parent,xAxis:{title:{text:u},categories:s},yAxis:{title:{text:i}},series:[{name:r,data:d}],number_format:l,parents:p,version:VERSION}}function barchartDoubleObject(e,t,r,n,a,o,u,i,l,c){var s=getIndices(e,r,n,a,o),d=uniqueCategories(t,s.category,s.order),p=[];return uniqueDataInColumnMaintainOrder(t,s.secondary).forEach(function(e){var r=_.filter(t,function(t){return t[s.secondary]===e}),n=[];_.forEach(d,function(e){n.push(valueForCategory(r,s.category,s.value,s.parent,e))}),p.push({name:e,data:n})}),{type:"bar",title:{text:u},xAxis:{title:{text:i},categories:d},yAxis:{title:{text:l}},series:sortChartSeries(p),number_format:c,version:VERSION}}function panelBarchartObject(e,t,r,n,a,o,u,i,l){var c=_.clone(e),s=getIndices(c.shift(),t,r,null,i,l),d=uniqueCategories(c,s.category,s.order),p=null,f=(p=isUndefinedOrNull(l)||"[None]"===l?uniqueDataInColumnMaintainOrder(c,s.secondary):uniqueDataInColumnOrdered(c,s.secondary,s.custom)).map(function(e){var r=_.filter(c,function(t){return t[s.secondary]===e}),n=d.map(function(e){return valueForCategory(r,s.category,s.value,s.parent,e)});return{type:"small_bar",title:{text:e},xAxis:{title:{text:a},categories:d},yAxis:{title:{text:o}},series:[{name:t,data:n}],number_format:u}});return{type:"panel_bar_chart",title:{text:n},xAxis:{title:{text:a},categories:d},yAxis:{title:{text:o}},panels:f,version:VERSION}}function linechartObject(e,t,r,n,a,o,u,i){var l=_.clone(e),c=getIndices(l.shift(),t,r,null,null,"[None]"===i?null:i),s=uniqueDataInColumnMaintainOrder(l,c.category),d=uniqueDataInColumnMaintainOrder(l,c.secondary),p=c.secondary,f=c.custom;if(f){var m=_.map(d,function(e){var t=_.findIndex(l,function(t){return t[p]===e});return l[t][f]});d=_.map(_.sortBy(_.zip(d,m),function(e){return e[1]}),function(e){return e[0]})}var h=[];return _.forEach(d,function(e){var t=[];_.forEach(s,function(r){t.push(valueForCategoryAndSeries(l,c.category,r,c.secondary,e,c.value))}),h.push({name:e,data:t})}),{type:"line",title:{text:n},xAxis:{title:{text:a},categories:s},yAxis:{title:{text:o}},series:sortChartSeries(h),number_format:u,version:VERSION}}function panelLinechartObject(e,t,r,n,a,o,u,i){var l=_.clone(e),c=getIndices(l.shift(),r,t,null,null,i),s=null;s=isUndefinedOrNull(i)||"[None]"===i?uniqueDataInColumnMaintainOrder(l,c.category):uniqueDataInColumnOrdered(l,c.category,c.custom);var d=uniqueDataInColumn(l,c.secondary);return{type:"panel_line_chart",title:{text:n},panels:_.map(s,function(e){var t=_.map(d,function(t){return valueForCategoryAndSeries(l,c.secondary,t,c.category,e,c.value)});return{type:"line",title:{text:e},xAxis:{title:{text:a},categories:d},yAxis:{title:{text:o}},series:[{name:e,data:t}],number_format:u}}),number_format:u,version:VERSION}}function componentChartObject(e,t,r,n,a,o,u,i,l){var c=_.clone(e),s=getIndices(c.shift(),t,r,null,i,l),d=null;d=isUndefinedOrNull(i)||"[None]"===i?uniqueDataInColumnMaintainOrder(c,s.category):uniqueDataInColumnOrdered(c,s.category,s.order);var p=null,f=(p=isUndefinedOrNull(l)||"[None]"===l?uniqueDataInColumnMaintainOrder(c,s.secondary).reverse():uniqueDataInColumnOrdered(c,s.secondary,s.custom).reverse()).map(function(e){var t=d.map(function(t){return valueForCategoryAndSeries(c,s.category,t,s.secondary,e,s.value)});return{name:e,data:t}});return{type:"component",title:{text:n},xAxis:{title:{text:a},categories:d},yAxis:{title:{text:o}},series:f,number_format:u,version:VERSION}}function uniqueCategories(e,t,r){return r?uniqueDataInColumnOrdered(e,t,r):uniqueDataInColumnMaintainOrder(e,t)}function valueForCategory(e,t,r,n,a){var o=e.filter(function(e){return e[t]===a});if(0===o.length)return{y:0,category:a};var u=o[0];if(u[t]===a){var i=isNumber(u[r]);if(n){var l=u[n],c={is_parent:l===a,is_child:l!==a,parent:l};return c.is_parent?{y:i?parseFloat(u[r]):0,relationships:c,category:u[t],color:defaultParentColor,text:i?"number":u[r]}:{y:i?parseFloat(u[r]):0,relationships:c,category:u[t],color:defaultChildColor,text:i?"number":u[r]}}return{y:i?parseFloat(u[r]):0,category:u[t],text:i?"number":u[r]}}}function isNumber(e){return!isNaN(parseFloat(e))}function valueForCategoryAndSeries(e,t,r,n,a,o){var u=_.filter(e,function(e){return e[t]===r&&e[n]===a});return u.length>0?parseFloat(u[0][o]):0}function sortChartSeries(e){return e.filter(function(e){return isNaN(toNumberSortValue(e.name))}).length>0?e:(e.forEach(function(e){e.name_value=toNumberSortValue(e.name)}),_.sortBy(e,function(e){return e.name_value}))}function toNumberSortValue(e){var t=parseFloat(e);return isNaN(t)?parseFloat(e.substring(1)):t}function isUndefinedOrNull(e){return void 0===e||null===e}function getIndices(e,t,r,n,a,o){var u=_.map(e,function(e){return e.toLowerCase()}),i=isUndefinedOrNull(t)?null:u.indexOf(t.toLowerCase()),l=isUndefinedOrNull(a)?i:u.indexOf(a.toLowerCase()),c=isUndefinedOrNull(n)?null:u.indexOf(n.toLowerCase()),s=isUndefinedOrNull(r)?null:u.indexOf(r.toLowerCase()),d=isUndefinedOrNull(o)?null:u.indexOf(o.toLowerCase());return{category:i>=0?i:null,order:l>=0?l:null,secondary:s>=0?s:null,value:u.indexOf("value"),parent:c>=0?c:null,custom:d>=0?d:null}}function buildTableObject(e,t,r,n,a,o,u,i,l,c,s,d){var p=null;return p=u&&u!==NONE_VALUE?groupedTable(e,t,r,n,a,o,u,l,i,c,s,d):simpleTable(e,t,r,n,a,o,l,i,c,s),preProcessTableObject(p)}function simpleTable(e,t,r,n,a,o,u,i,l,c){var s=_.clone(e),d=s.shift(),p=d.indexOf(a),f=_.map(u,function(e){return d.indexOf(e)}),m=p,h=!1;if(o&&o!==NONE_VALUE&&(m=d.indexOf(o),h=!0),i&&i!==NONE_VALUE)var v=d.indexOf(i);var b=_.map(s,function(e,t){var r={is_parent:!1,is_child:!1,parent:e[p]};if(h){var n=e[m],a=e[p];r={is_parent:n===a,is_child:n!==a,parent:n}}var o=_.map(f,function(t){return e[t]}),u=_.map(o,function(e){return numVal(e)});return v?{category:e[p],relationships:r,order:e[v],values:o,sort_values:u}:{category:e[p],relationships:r,order:t,values:o,sort_values:u}});return b=_.sortBy(b,function(e){return e.order}),h&&(b=adjustSimpleTableDataForParents(b)),{type:"simple",parent_child:h,header:t,subtitle:r,footer:n,category:a,columns:l,data:b,category_caption:null==c?a:c}}function buildDataObjects(e,t,r,n,a,o,u,i,l){return _.map(e,function(e){var c=_.filter(t,function(t){return t[r]===e}),s=_.map(c,function(e,t){var r={is_parent:!1,is_child:!1,parent:e[n]};if(a){var c=e[o],s=e[n];r={is_parent:c===s,is_child:c!==s,parent:c}}var d=u===i?t:e[u],p=_.map(l,function(t){return e[t]}),f=_.map(p,function(e){return numVal(e)});return{category:e[n],relationships:r,order:d,values:p,sort_values:f}});return{group:e,data:s}})}function templateGroupTable(e,t,r,n){return{type:"grouped",category:e,title:{text:"Grouped Table"},header:t,columns:r,groups:n}}function getDataByGroup(e,t,r,n){var a=uniqueDataInColumnMaintainOrder(e,t);if(r&&r!==NONE_VALUE){var o=n.indexOf(r),u=_.map(a,function(r){var n=_.findIndex(e,function(e){return e[t]===r});return e[n][o]});a=_.map(_.sortBy(_.zip(a,u),function(e){return e[1]}),function(e){return e[0]})}return a}function groupedTable(e,t,r,n,a,o,u,i,l,c,s,d){var p=_.clone(e),f=p.shift(),m=f.indexOf(a),h=_.map(i,function(e){return f.indexOf(e)}),v=f.indexOf(u),b=-2;null===l?b=m:l!==NONE_VALUE&&(b=f.indexOf(l));var g=m,y=!1;o&&o!==NONE_VALUE&&(g=f.indexOf(o),y=!0);var O=buildDataObjects(getDataByGroup(p,v,d,f),p,v,m,y,g,b,-2,h),x=templateGroupTable(a,t,c,O=adjustGroupedTableDataForParents(O)),C=[""].concat(_.map(x.groups,function(e){return e.group})),T=_.map(x.groups[0].data,function(e){return e.category}),N=_.map(T,function(e){return dataItemWithCategory(x,e)});return{group_columns:C,type:"grouped",category:a,group_column:u,columns:c,data:N=_.sortBy(N,function(e){return e.order}),header:t,subtitle:r,footer:n,groups:O=_.map(O,function(e){return e.data=_.sortBy(e.data,function(e){return e.order}),e}),parent_child:y,category_caption:null==s?a:s}}function dataItemWithCategory(e,t){var r=[],n="",a="",o={};_.forEach(e.groups,function(e){var u=_.findWhere(e.data,{category:t});n=u.order,a=u.parent,o=u.relationships,_.forEach(u.values,function(e){r.push(e)})});var u=_.map(r,function(e){return numVal(e)});return{category:t,relationships:o,parent:a,order:n,values:r,sort_values:u}}function getColumnIndex(e,t){return parent_column&&parent_column!==NONE_VALUE?e.indexOf(t):null}function columnDecimalPlaces(e){var t=[];for(var r in e.data[0].values){var n=_.map(e.data,function(e){return e.values[r]});t.push(seriesDecimalPlaces(n))}return t}function columnCouldBeAYear(e){var t=[];for(var r in e.data[0].values){var n=_.map(e.data,function(e){return e.values[r]});t.push(seriesCouldBeYear(n))}return t}function groupedTableDecimalPlaces(e){var t=[];for(var r in e.groups[0].data[0].values){var n=_.flatten(_.map(e.groups,function(e){return _.map(e.data,function(e){return e.values[r]})}));t.push(seriesDecimalPlaces(n))}return t}function groupedTableCouldBeAYear(e){var t=[];for(var r in e.groups[0].data[0].values){var n=_.flatten(_.map(e.groups,function(e){return _.map(e.data,function(e){return e.values[r]})}));t.push(seriesCouldBeYear(n))}return t}function preProcessTableObject(e){return"simple"===e.type?preProcessSimpleTableObject(e):"grouped"===e.type&&preProcessGroupedTableObject(e),e}function preProcessSimpleTableObject(e){var t=columnDecimalPlaces(e),r=columnCouldBeAYear(e);e.data=_.map(e.data,function(e){return e.values=_.map(_.zip(e.values,t,r),function(e){return!1===e[2]?formatNumberWithDecimalPlaces(e[0],e[1]):e[0]}),e})}function preProcessGroupedTableObject(e){var t=groupedTableDecimalPlaces(e),r=groupedTableCouldBeAYear(e);e.groups=_.map(e.groups,function(e){return e.data=_.map(e.data,function(e){return e.values=_.map(_.zip(e.values,t,r),function(e){return!1===e[2]?formatNumberWithDecimalPlaces(e[0],e[1]):e[0]}),e}),e}),e.data=[];for(var n in e.groups[0].data){var a=_.clone(e.groups[0].data[n]);a.values=_.flatten(_.map(e.groups,function(e){return e.data[n].values})),a.sort_values=_.flatten(_.map(e.groups,function(e){return e.data[n].sort_values})),e.data.push(a)}var o=_.sortBy(e.groups[0].data,function(e){return e.order}),u=_.map(o,function(e){return e.category});_.forEach(u,function(n){var a="<tr><th>"+n+"</th>";_.forEach(e.groups,function(e){var o=_.findWhere(e.data,{category:n});_.forEach(_.zip(o.values,t,r),function(e){a=e[2]?a+"<td>"+e[0]+"</td>":a+"<td>"+formatNumberWithDecimalPlaces(e[0],e[1])+"</td>"})})})}function numVal(e,t){var r=String(e).replace(/\,/g,""),n=Number(r);return n||e}function addMissingSimpleTableParentItems(e){var t=_.uniq(_.map(e,function(e){return e.relationships.parent})),r=_.map(e,function(e){return e.category}),n=_.filter(t,function(e){return!_.contains(r,e)}),a=_.clone(e),o=e[0];return _.forEach(n,function(t){var r=_.filter(e,function(e){return e.relationships.parent===t}),n=_.min(_.map(r,function(e){return e.order}))-1,u={category:t,order:n,relationships:{is_child:!1,is_parent:!0,parent:t},sort_values:_.map(o.sort_values,function(e){return 0}),values:_.map(o.values,function(e){return""})};a.push(u)}),a}function adjustSimpleTableDataForParents(e){return reorderSimpleTableDataForParentChild(addMissingSimpleTableParentItems(e))}function reorderSimpleTableDataForParentChild(e){var t=_.object(_.map(e,function(e){return[e.category,e]})),r=_.uniq(_.map(e,function(e){return e.relationships.parent})),n=[];return _.forEach(r,function(r){n.push(t[r]);var a=_.filter(e,function(e){return e.category!==r&&e.relationships.parent===r});n=n.concat(a)}),n}function adjustGroupedTableDataForParents(e){return reorderGroupedTableDataForParentChild(addMissingGroupedTableParentItems(e))}function addMissingGroupedTableParentItems(e){var t=_.uniq(_.flatten(_.map(e,function(e){return _.map(e.data,function(e){return e.relationships.parent})}))),r=_.uniq(_.flatten(_.map(e,function(e){return _.map(e.data,function(e){return e.category})}))),n=_.filter(t,function(e){return!_.contains(r,e)}),a=_.clone(e),o=e[0].data[0];return _.forEach(n,function(t){var r=_.filter(_.flatten(_.map(e,function(e){return e.data})),function(e){return e.relationships.parent===t}),n=_.min(_.map(r,function(e){return e.order}))-1;_.forEach(a,function(e){var r={category:t,order:n,relationships:{is_child:!1,is_parent:!0,parent:t},sort_values:_.map(o.sort_values,function(e){return 0}),values:_.map(o.values,function(e){return""})};e.data.push(r)})}),a}function reorderGroupedTableDataForParentChild(e){_.object(_.map(e,function(e){return[e.category,e]}));var t=_.uniq(_.flatten(_.map(e,function(e){return _.map(e.data,function(e){return e.relationships.parent})})));return _.forEach(e,function(e){var r=_.object(_.map(e.data,function(e){return[e.category,e]})),n=[];_.forEach(t,function(t){n.push(r[t]);var a=_.filter(e.data,function(e){return e.category!==t&&e.relationships.parent===t});n=n.concat(a)}),e.data=n}),e}function drawTable(e,t){return preProcessTableObject(t),"simple"===t.type?simpleHtmlTable(e,t):"grouped"===t.type?groupedHtmlTable(e,t):void 0}function simpleHtmlTable(e,t){var r="";return r=appendTableTitle(r,t),r=appendTableSubtitle(r,t),r+="<table class='table table-sm'>",r=appendSimpleTableHeader(r,t),r=appendSimpleTableBody(r,t),r+="</table>",$("#"+e).html(r),!0}function groupedHtmlTable(e,t){var r="";return r=appendTableTitle(r,t),r=appendTableSubtitle(r,t),r+="<table class='table table-sm'>",r=appendGroupTableHeader(r,t),r=appendGroupedTableBody(r,t),r+="</table>",r=insertTableFooter(r,t),$("#"+e).html(r),!0}function appendSimpleTableBody(e,t){var r="<tbody>";return _.forEach(t.data,function(e){r+="<tr>",t.parent_child?e.relationships.is_parent?r+='<th class="parent_row">':r+='<th class="child_row">':r+="<th>",r=r+e.category+"</th>",_.forEach(e.values,function(e){r=r+"<td>"+e+"</td>"}),r+="</tr>"}),r+="</tbody>",e+r}function appendGroupedTableBody(e,t){var r="<tbody>",n=_.sortBy(t.groups[0].data,function(e){return e.order});return _.forEach(n,function(e){var n=e.category,a="<tr>";t.parent_child?e.relationships.is_parent?a+='<th class="parent_row">':a+='<th class="child_row">':a+="<th>",a=a+n+"</th>",_.forEach(t.groups,function(e){var t=_.findWhere(e.data,{category:n});_.forEach(t.values,function(e){a=a+"<td>"+e+"</td>"})}),r+=a+="</tr>"}),r+="</tbody>",e+r}function appendTableTitle(e,t){return t.header&&""!==t.header?e+"<div class='table-title heading-small'>"+t.header+"</div>":e}function insertTableFooter(e,t){return t.footer&&""!==t.footer?e+"<div class='table-footer'>"+t.footer+"</div>":e}function appendTableSubtitle(e,t){return t.subtitle&&""!==t.subtitle?e+"<div class='table-subtitle'>"+t.subtitle+"</div>":e}function appendSimpleTableHeader(e,t){var r="";return r=null==t.category_caption?"<thead><tr><th></th>":"<thead><tr><th>"+t.category_caption+"</th>",_.forEach(t.columns,function(e){r=r+"<th>"+e+"</th>"}),r+="</tr></thead>",e+r}function appendGroupTableHeader(e,t){var r="";r=null==t.category_caption?"<thead><tr><th></th>":"<thead><tr><th>"+t.category_caption+"</th>",_.forEach(t.groups,function(e){r+=multicell(e.group,t.columns.length)}),r+="</tr>";var n=!1;return _.forEach(t.columns,function(e){""!==e&&(n=!0)}),n&&(r+="<tr><td></td>",_.forEach(t.groups,function(e){_.forEach(t.columns,function(e){r=r+"<td>"+e+"</td>"})}),r+="</tr>"),r+="</thead>",e+r}function multicell(e,t){return"<td colspan="+t+">"+e+"</td>"}var defaultParentColor="#2B8CC4",defaultChildColor="#B3CBD9",VERSION="1.1";if("undefined"!=typeof exports){var _=require("../charts/vendor/underscore-min"),uniqueDataInColumnMaintainOrder=(dataTools=require("../charts/rd-data-tools")).uniqueDataInColumnMaintainOrder;exports.barchartObject=barchartObject,exports.linechartObject=linechartObject,exports.componentChartObject=componentChartObject,exports.panelLinechartObject=panelLinechartObject,exports.panelBarchartObject=panelBarchartObject}var NONE_VALUE="[None]";if("undefined"!=typeof exports){var _=require("../charts/vendor/underscore-min"),dataTools=require("../charts/rd-data-tools"),uniqueDataInColumnMaintainOrder=dataTools.uniqueDataInColumnMaintainOrder,seriesDecimalPlaces=dataTools.seriesDecimalPlaces,seriesCouldBeYear=dataTools.seriesCouldBeYear,formatNumberWithDecimalPlaces=dataTools.formatNumberWithDecimalPlaces;exports.buildTableObject=buildTableObject,exports.simpleTable=simpleTable,exports.groupedTable=groupedTable}$(document).ready(function(){var e=$(".sticky-js");$.each(e,function(){var e=parseInt($(this).position().top);$(window).scroll(function(){$(window).scrollTop()>=e?$(this).addClass("sticky-js-fixed"):$(this).removeClass("sticky-js-fixed")}.bind(this))})});
//# sourceMappingURL=cms.js.map
