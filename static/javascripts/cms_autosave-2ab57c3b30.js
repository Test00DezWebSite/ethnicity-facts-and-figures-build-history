function PreviewAndEditSection(n){var s,i,a,l,c;n=n;function r(e){i.classList.contains("hidden")||e.target.classList.contains("js-dependent")||u(e)}function o(e){f(),a[0]&&(s.classList.contains("empty")?a[0].value="":a[0].value=s.textContent),e.preventDefault()}function d(e){13==e.keyCode&&u(e)}function u(e){var t;if(a[0])t=a[0].value.trim();else if(l)t=l.value.trim(),l.classList.contains("for-bullets")?s.innerHTML=t.replace(/^\*\s/gm,"<li>").replace(/\n/g,"</li>"):l.classList.contains("for-paragraphs")&&(s.innerHTML=t.replace(/\n/g,"<br>").replace(/\n/g,"</li>"));else if(0<c.length){for(var n=[],i=0;i<c.length;i++)if(c[i].checked){var r=c[i].getAttribute("id"),o=document.querySelector("label[for="+r+"]");o?n.push(o.textContent):console.warn("Missing label for checkbox with ID "+r)}0<n.length&&(t=n.join(", "))}t&&s.getAttribute("data-preview-text")&&(t=s.getAttribute("data-preview-text")),t&&""!=t?(s.textContent=t,s.classList.remove("empty")):(s.classList.add("empty"),s.textContent=s.getAttribute("data-empty-text")),f(),e.preventDefault()}function p(e){13==e.keyCode&&t()}function v(e){t()}function t(){s.classList.toggle("hidden"),i.classList.toggle("hidden"),a[0]&&a[0].focus(),l&&l.focus()}function f(){i.classList.add("hidden"),s.classList.remove("hidden")}!function(){s=n.querySelector(".preview"),i=n.querySelector(".edit"),a=i.querySelectorAll("input[type=text]:not(.js-dependent), input[type=url]:not(.js-dependent)"),l=i.querySelector("textarea"),c=i.querySelectorAll("input[type=checkbox], input[type=radio]"),radioButtons=i.querySelectorAll("input[type=radio]"),s.addEventListener("click",v),s.addEventListener("keyup",p),1==a.length&&(a[0].addEventListener("blur",r),a[0].addEventListener("keyup",d));l&&l.addEventListener("blur",r);var e=i.querySelector(".cancel");e&&e.addEventListener("click",o);var t=i.querySelector(".save");t&&t.addEventListener("click",u)}()}function setupAutosave(){for(var e=document.querySelectorAll(".preview-and-edit"),t=0;t<e.length;t++)new PreviewAndEditSection(e[t])}function moveDimensionUp(e){e.preventDefault();var t=$(e.currentTarget).parents("tr:first");0<t.prev().length&&(t.insertBefore(t.prev()),syncDimensionOrder())}function moveDimensionDown(e){e.preventDefault();var t=$(e.currentTarget).parents("tr:last");0<t.next().length&&(t.insertAfter(t.next()),syncDimensionOrder())}function syncDimensionOrder(){var n,e=$("tr.movable"),i=[];$(e).each(function(e,t){n=$(t).data("dimension-guid"),i.push({index:e,guid:n})}),$.ajax({type:"POST",url:set_dimension_order_post_url,dataType:"json",contentType:"application/json",data:JSON.stringify({dimensions:i})})}document.addEventListener("DOMContentLoaded",setupAutosave),document.addEventListener("DOMContentLoaded",function(){for(var e=document.querySelectorAll("select.publisher"),t=0;t<e.length;t++)govukGovernmentOrganisationsAutocomplete({selectElement:e[t],showAllValues:!1,minLength:2,defaultValue:""})}),$(document).ready(function(){$(".move-up").click(moveDimensionUp),$(".move-down").click(moveDimensionDown)});
//# sourceMappingURL=cms_autosave.js.map
