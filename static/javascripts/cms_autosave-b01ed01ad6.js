function PreviewAndEditSection(n){var i,r,s,o;n=n;function a(e){r.classList.contains("hidden")||e.target.classList.contains("js-dependent")||d(e)}function c(e){p(),s[0]&&(i.classList.contains("empty")?s[0].value="":s[0].value=i.textContent),e.preventDefault()}function l(e){13==e.keyCode&&d(e)}function d(e){var t;s[0]&&(""==(t=s[0].value.trim())?(i.classList.add("empty"),i.textContent=i.getAttribute("data-empty-text")):(i.textContent=t,i.classList.remove("empty")));o&&(""==(t=o.value.trim())?(i.classList.add("empty"),i.textContent=i.getAttribute("data-empty-text")):(o.classList.contains("for-bullets")?i.innerHTML=t.replace(/^\*\s/gm,"<li>").replace(/\n/g,"</li>"):o.classList.contains("for-paragraphs")?i.innerHTML=t.replace(/\n/g,"<br>").replace(/\n/g,"</li>"):i.innerHTML=t,i.classList.remove("empty")));p(),e.preventDefault()}function u(e){13==e.keyCode&&t()}function v(e){t()}function t(){i.classList.toggle("hidden"),r.classList.toggle("hidden"),s[0]&&s[0].focus(),o&&o.focus()}function p(){r.classList.add("hidden"),i.classList.remove("hidden")}!function(){i=n.querySelector(".preview"),r=n.querySelector(".edit"),s=r.querySelectorAll("input[type=text]"),o=r.querySelector("textarea"),i.addEventListener("click",v),i.addEventListener("keyup",u),1==s.length&&(s[0].addEventListener("blur",a),s[0].addEventListener("keyup",l));o&&o.addEventListener("blur",a);var e=r.querySelector(".cancel");e&&e.addEventListener("click",c);var t=r.querySelector(".save");t&&t.addEventListener("click",d)}()}function setupAutosave(){for(var e=document.querySelectorAll(".preview-and-edit"),t=0;t<e.length;t++)new PreviewAndEditSection(e[t])}function moveDimensionUp(e){e.preventDefault();var t=$(e.currentTarget).parents("tr:first");0<t.prev().length&&(t.insertBefore(t.prev()),syncDimensionOrder())}function moveDimensionDown(e){e.preventDefault();var t=$(e.currentTarget).parents("tr:last");0<t.next().length&&(t.insertAfter(t.next()),syncDimensionOrder())}function syncDimensionOrder(){var n,e=$("tr.movable"),i=[];$(e).each(function(e,t){n=$(t).data("dimension-guid"),i.push({index:e,guid:n})}),$.ajax({type:"POST",url:set_dimension_order_post_url,dataType:"json",contentType:"application/json",data:JSON.stringify({dimensions:i})})}document.addEventListener("DOMContentLoaded",setupAutosave),document.addEventListener("DOMContentLoaded",function(){for(var e=document.querySelectorAll("select.publisher"),t=0;t<e.length;t++)govukGovernmentOrganisationsAutocomplete({selectElement:e[t],showAllValues:!1,minLength:2,defaultValue:""})}),$(document).ready(function(){$(".move-up").click(moveDimensionUp),$(".move-down").click(moveDimensionDown)});
//# sourceMappingURL=cms_autosave.js.map
